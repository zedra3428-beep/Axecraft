{"ast":null,"code":"import _objectWithoutProperties from \"/app/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"container\"];\nimport { resize, frame, cancelFrame, frameData } from 'motion-dom';\nimport { noop } from 'motion-utils';\nimport { createScrollInfo } from './info.mjs';\nimport { createOnScrollHandler } from './on-scroll-handler.mjs';\nconst scrollListeners = new WeakMap();\nconst resizeListeners = new WeakMap();\nconst onScrollHandlers = new WeakMap();\nconst getEventTarget = element => element === document.scrollingElement ? window : element;\nfunction scrollInfo(onScroll) {\n  let _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n    {\n      container = document.scrollingElement\n    } = _ref,\n    options = _objectWithoutProperties(_ref, _excluded);\n  if (!container) return noop;\n  let containerHandlers = onScrollHandlers.get(container);\n  /**\n   * Get the onScroll handlers for this container.\n   * If one isn't found, create a new one.\n   */\n  if (!containerHandlers) {\n    containerHandlers = new Set();\n    onScrollHandlers.set(container, containerHandlers);\n  }\n  /**\n   * Create a new onScroll handler for the provided callback.\n   */\n  const info = createScrollInfo();\n  const containerHandler = createOnScrollHandler(container, onScroll, info, options);\n  containerHandlers.add(containerHandler);\n  /**\n   * Check if there's a scroll event listener for this container.\n   * If not, create one.\n   */\n  if (!scrollListeners.has(container)) {\n    const measureAll = () => {\n      for (const handler of containerHandlers) {\n        handler.measure(frameData.timestamp);\n      }\n      frame.preUpdate(notifyAll);\n    };\n    const notifyAll = () => {\n      for (const handler of containerHandlers) {\n        handler.notify();\n      }\n    };\n    const listener = () => frame.read(measureAll);\n    scrollListeners.set(container, listener);\n    const target = getEventTarget(container);\n    window.addEventListener(\"resize\", listener, {\n      passive: true\n    });\n    if (container !== document.documentElement) {\n      resizeListeners.set(container, resize(container, listener));\n    }\n    target.addEventListener(\"scroll\", listener, {\n      passive: true\n    });\n    listener();\n  }\n  const listener = scrollListeners.get(container);\n  frame.read(listener, false, true);\n  return () => {\n    cancelFrame(listener);\n    /**\n     * Check if we even have any handlers for this container.\n     */\n    const currentHandlers = onScrollHandlers.get(container);\n    if (!currentHandlers) return;\n    currentHandlers.delete(containerHandler);\n    if (currentHandlers.size) return;\n    /**\n     * If no more handlers, remove the scroll listener too.\n     */\n    const scrollListener = scrollListeners.get(container);\n    scrollListeners.delete(container);\n    if (scrollListener) {\n      var _resizeListeners$get;\n      getEventTarget(container).removeEventListener(\"scroll\", scrollListener);\n      (_resizeListeners$get = resizeListeners.get(container)) === null || _resizeListeners$get === void 0 || _resizeListeners$get();\n      window.removeEventListener(\"resize\", scrollListener);\n    }\n  };\n}\nexport { scrollInfo };","map":{"version":3,"names":["scrollListeners","WeakMap","resizeListeners","onScrollHandlers","getEventTarget","element","document","scrollingElement","window","scrollInfo","onScroll","_ref","arguments","length","undefined","container","options","_objectWithoutProperties","_excluded","noop","containerHandlers","get","Set","set","info","createScrollInfo","containerHandler","createOnScrollHandler","add","has","measureAll","handler","measure","frameData","timestamp","frame","preUpdate","notifyAll","notify","listener","read","target","addEventListener","passive","documentElement","resize","cancelFrame","currentHandlers","delete","size","scrollListener","_resizeListeners$get","removeEventListener"],"sources":["/app/frontend/node_modules/framer-motion/src/render/dom/scroll/track.ts"],"sourcesContent":["import { cancelFrame, frame, frameData, resize } from \"motion-dom\"\nimport { noop } from \"motion-utils\"\nimport { createScrollInfo } from \"./info\"\nimport { createOnScrollHandler } from \"./on-scroll-handler\"\nimport { OnScrollHandler, OnScrollInfo, ScrollInfoOptions } from \"./types\"\n\nconst scrollListeners = new WeakMap<Element, VoidFunction>()\nconst resizeListeners = new WeakMap<Element, VoidFunction>()\nconst onScrollHandlers = new WeakMap<Element, Set<OnScrollHandler>>()\n\nexport type ScrollTargets = Array<HTMLElement>\n\nconst getEventTarget = (element: Element) =>\n    element === document.scrollingElement ? window : element\n\nexport function scrollInfo(\n    onScroll: OnScrollInfo,\n    {\n        container = document.scrollingElement as Element,\n        ...options\n    }: ScrollInfoOptions = {}\n) {\n    if (!container) return noop as VoidFunction\n\n    let containerHandlers = onScrollHandlers.get(container)\n\n    /**\n     * Get the onScroll handlers for this container.\n     * If one isn't found, create a new one.\n     */\n    if (!containerHandlers) {\n        containerHandlers = new Set()\n        onScrollHandlers.set(container, containerHandlers)\n    }\n\n    /**\n     * Create a new onScroll handler for the provided callback.\n     */\n    const info = createScrollInfo()\n    const containerHandler = createOnScrollHandler(\n        container,\n        onScroll,\n        info,\n        options\n    )\n    containerHandlers.add(containerHandler)\n\n    /**\n     * Check if there's a scroll event listener for this container.\n     * If not, create one.\n     */\n    if (!scrollListeners.has(container)) {\n        const measureAll = () => {\n            for (const handler of containerHandlers) {\n                handler.measure(frameData.timestamp)\n            }\n\n            frame.preUpdate(notifyAll)\n        }\n\n        const notifyAll = () => {\n            for (const handler of containerHandlers) {\n                handler.notify()\n            }\n        }\n\n        const listener = () => frame.read(measureAll)\n\n        scrollListeners.set(container, listener)\n\n        const target = getEventTarget(container)\n        window.addEventListener(\"resize\", listener, { passive: true })\n        if (container !== document.documentElement) {\n            resizeListeners.set(container, resize(container, listener))\n        }\n\n        target.addEventListener(\"scroll\", listener, { passive: true })\n\n        listener()\n    }\n\n    const listener = scrollListeners.get(container)!\n    frame.read(listener, false, true)\n\n    return () => {\n        cancelFrame(listener)\n\n        /**\n         * Check if we even have any handlers for this container.\n         */\n        const currentHandlers = onScrollHandlers.get(container)\n        if (!currentHandlers) return\n\n        currentHandlers.delete(containerHandler)\n\n        if (currentHandlers.size) return\n\n        /**\n         * If no more handlers, remove the scroll listener too.\n         */\n        const scrollListener = scrollListeners.get(container)\n        scrollListeners.delete(container)\n\n        if (scrollListener) {\n            getEventTarget(container).removeEventListener(\n                \"scroll\",\n                scrollListener\n            )\n            resizeListeners.get(container)?.()\n            window.removeEventListener(\"resize\", scrollListener)\n        }\n    }\n}\n"],"mappings":";;;;;;AAMA,MAAMA,eAAe,GAAG,IAAIC,OAAO,EAAyB;AAC5D,MAAMC,eAAe,GAAG,IAAID,OAAO,EAAyB;AAC5D,MAAME,gBAAgB,GAAG,IAAIF,OAAO,EAAiC;AAIrE,MAAMG,cAAc,GAAIC,OAAgB,IACpCA,OAAO,KAAKC,QAAQ,CAACC,gBAAgB,GAAGC,MAAM,GAAGH,OAAO;AAE5C,SAAAI,UAAUA,CACtBC,QAAsB,EAIG;EAAA,IAAAC,IAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAF,EAAE;IAHzB;MACIG,SAAS,GAAGT,QAAQ,CAACC;IACX,IAAAI,IAAA;IAAPK,OAAO,GAAAC,wBAAA,CAAAN,IAAA,EAAAO,SAAA;EAGd,IAAI,CAACH,SAAS,EAAE,OAAOI,IAAoB;EAE3C,IAAIC,iBAAiB,GAAGjB,gBAAgB,CAACkB,GAAG,CAACN,SAAS,CAAC;EAEvD;;;AAGG;EACH,IAAI,CAACK,iBAAiB,EAAE;IACpBA,iBAAiB,GAAG,IAAIE,GAAG,EAAE;IAC7BnB,gBAAgB,CAACoB,GAAG,CAACR,SAAS,EAAEK,iBAAiB,CAAC;;EAGtD;;AAEG;EACH,MAAMI,IAAI,GAAGC,gBAAgB,EAAE;EAC/B,MAAMC,gBAAgB,GAAGC,qBAAqB,CAC1CZ,SAAS,EACTL,QAAQ,EACRc,IAAI,EACJR,OAAO,CACV;EACDI,iBAAiB,CAACQ,GAAG,CAACF,gBAAgB,CAAC;EAEvC;;;AAGG;EACH,IAAI,CAAC1B,eAAe,CAAC6B,GAAG,CAACd,SAAS,CAAC,EAAE;IACjC,MAAMe,UAAU,GAAGA,CAAA,KAAK;MACpB,KAAK,MAAMC,OAAO,IAAIX,iBAAiB,EAAE;QACrCW,OAAO,CAACC,OAAO,CAACC,SAAS,CAACC,SAAS,CAAC;;MAGxCC,KAAK,CAACC,SAAS,CAACC,SAAS,CAAC;IAC9B,CAAC;IAED,MAAMA,SAAS,GAAGA,CAAA,KAAK;MACnB,KAAK,MAAMN,OAAO,IAAIX,iBAAiB,EAAE;QACrCW,OAAO,CAACO,MAAM,EAAE;;IAExB,CAAC;IAED,MAAMC,QAAQ,GAAGA,CAAA,KAAMJ,KAAK,CAACK,IAAI,CAACV,UAAU,CAAC;IAE7C9B,eAAe,CAACuB,GAAG,CAACR,SAAS,EAAEwB,QAAQ,CAAC;IAExC,MAAME,MAAM,GAAGrC,cAAc,CAACW,SAAS,CAAC;IACxCP,MAAM,CAACkC,gBAAgB,CAAC,QAAQ,EAAEH,QAAQ,EAAE;MAAEI,OAAO,EAAE;IAAI,CAAE,CAAC;IAC9D,IAAI5B,SAAS,KAAKT,QAAQ,CAACsC,eAAe,EAAE;MACxC1C,eAAe,CAACqB,GAAG,CAACR,SAAS,EAAE8B,MAAM,CAAC9B,SAAS,EAAEwB,QAAQ,CAAC,CAAC;;IAG/DE,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEH,QAAQ,EAAE;MAAEI,OAAO,EAAE;IAAI,CAAE,CAAC;IAE9DJ,QAAQ,EAAE;;EAGd,MAAMA,QAAQ,GAAGvC,eAAe,CAACqB,GAAG,CAACN,SAAS,CAAE;EAChDoB,KAAK,CAACK,IAAI,CAACD,QAAQ,EAAE,KAAK,EAAE,IAAI,CAAC;EAEjC,OAAO,MAAK;IACRO,WAAW,CAACP,QAAQ,CAAC;IAErB;;AAEG;IACH,MAAMQ,eAAe,GAAG5C,gBAAgB,CAACkB,GAAG,CAACN,SAAS,CAAC;IACvD,IAAI,CAACgC,eAAe,EAAE;IAEtBA,eAAe,CAACC,MAAM,CAACtB,gBAAgB,CAAC;IAExC,IAAIqB,eAAe,CAACE,IAAI,EAAE;IAE1B;;AAEG;IACH,MAAMC,cAAc,GAAGlD,eAAe,CAACqB,GAAG,CAACN,SAAS,CAAC;IACrDf,eAAe,CAACgD,MAAM,CAACjC,SAAS,CAAC;IAEjC,IAAImC,cAAc,EAAE;MAAA,IAAAC,oBAAA;MAChB/C,cAAc,CAACW,SAAS,CAAC,CAACqC,mBAAmB,CACzC,QAAQ,EACRF,cAAc,CACjB;MACD,CAAAC,oBAAA,GAAAjD,eAAe,CAACmB,GAAG,CAACN,SAAS,CAAC,cAAAoC,oBAAA,eAA9BA,oBAAA,CAA8B,CAAI;MAClC3C,MAAM,CAAC4C,mBAAmB,CAAC,QAAQ,EAAEF,cAAc,CAAC;;EAE5D,CAAC;AACL","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}